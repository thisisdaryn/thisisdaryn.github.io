<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Intro to Statistical Inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="thisisdaryn at gmail dot com" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Intro to Statistical Inference
## Daryn Ramsden
### thisisdaryn at gmail dot com
### last updated: 2019-10-29

---








### Statistical Inference

#### inference: reasoning about the population based on data collected from a sample 

---
### Relationship between sample and population


&lt;img src="images/sampling/Sampling.png" width="1813" style="display: block; margin: auto;" /&gt;




---
### Parameters and sample statistics

  * parameters are characteristics of the population that we want in ideally
    * e.g. mean, proportion with a specified characteristic
    
  * sample statistics are things we can measure or calculate in the sample population
  
  * typically, for each parameter there's an accompanying sample statistic



---
### How do population parameters and sample statistics differ?

Consider a population: 

`$$\mu \mbox{, the mean of the entire population (parameter)}$$`


`$$\bar{x} \mbox{, the mean of a sample (sample statistic)}$$`


How do the two quantities compare?
  
  * What effect does sample size have?
  
  * What effect does the variability in the population have?


---
### First type of inference: Point Estimate for the mean


For the mean of a single population:
  * the sample mean is the best estimate we can come up with
  
  * there is a question of how confident we can be in this estimate



---
### Central Limit Theorem

Under a large variety of circumstances: 

`$$ X \sim N(\mu, \sigma) $$`

`$$ \implies \bar{X} \sim N\left(\mu, \frac{\sigma}{\sqrt{n}}\right) $$`



---
### Brief pause for some terminology


  * The distribution of the sample statistic is known as the **sampling distribution**
  
  * the standard deviation of the sampling distribution is known as the **standard error**


---
### When can we use the CLT?

Conditions necessary for the Central Limit theorem to hold:

  * the sample must be random
  
  * the sample should be less than 10% of the population 
  
  * either:
  
    * the underlying distribution is normal
  
    * the sample size is sufficiently large (typically &gt; 30)
  

---
### How does that actually help us?


  * the sample mean is the best estimate we can come up with for the population mean
  
--

  * the sample mean is almost certainly wrong though
  
--

  * Can the CLT help us out?



---
### Confidence Interval for mean 

  
  * We can use the CLT to form a confidence interval
  
--

  * What is a confidence interval?

--
  
    * a plausible range of values for the mean
    
  
---
### CI if CLT holds



  * if the CLT holds, we know that the sample mean will be within 1.96 standard errors of the true mean 95% of the time

--
  
  * conversely, the true (population) mean will be within 1.96 standard errors of the sample mean, 95% of the time.
  
  
--

  * therefore we can construct an interval centered around the sample mean that would plausibly contain the true (population) mean
  
  
  
---
### But we have a problem

  * to form the interval we need the standard error
  
--

  * so we have to use our best estimate: we use the sample sd, _s_ in lieu of the population standard deviation 
  
--

  `$$ \mbox{95% CI:    }  \bar{x} \pm 1.96 \frac{s}{\sqrt{n}}$$`
  


---
### What about other confidence intervals?

  * what multiplier should we use for a 90% confidence interval?
  
--

  * a multiplier of 1.5 corresponds to what confidence interval? 


---
### And what if the CLT does not hold?

Well ... there's the t-distribution(s).


&lt;img src="images/Normalvstdist.png" width="2952" style="display: block; margin: auto;" /&gt;

  * confidence intervals will be wider than those that we get using multipliers from the normal distribution.

---
### There isn't a single t-distribution


&lt;img src="images/DifferentTdistsCompNormal.png" width="3115" style="display: block; margin: auto;" /&gt;

Each value of df (degrees of freedom) specifies a different t-distribution

As df gets larger, the t-distribution gets closer to the normal distribution

t-distributions have more of the distribution in the tails (as compared to the normal)

confidence intervals will be wider i.e. more conservative estimates



---
### What do the degrees of freedom represent?

Number of values in a sample that are free to vary if a sample statistic is known.

If the sample mean is known, how many of the sample values are free to vary before the remaining sample values are fixed?

df = n-1




---
### Using the t-distribution

If conditions are not met for using the multipliers from the normal distribution

`$$ CI = \bar{x} \pm {t^{*}}_{df} $$`
`$$ df = n - 1 $$`



---
### Working with the t-distribution in R 

  * &lt;tt&gt;pt&lt;/tt&gt;: 
  
  * &lt;tt&gt;qt&lt;/tt&gt;
  
  
In fact, for any well-known distribution, R probably has analogous functions, Example
  * pbinom, qbinom: binomial distribution
  * punif, qunif: uniform distribution
  * pgeom, qgeom: geometric distribution  
  * ppois, qpois: Poisson distribution
  
  
  
---
### Inference type 2: Is the true mean a particular value?

Question: is the population mean equal to a specified value?

* We don't necessarily ask this question explicitly, but it is the building block in other types of inferential questions.
  * e.g. if we want to know if two groups have the same mean, we can ask if the difference of their means is 0
  
  
---
### Two different approaches

a. Using confidence intervals
  1. Use previous methods to form confidence interval for the population mean
  2. If the value is not in the confidence interval, we reject the assumption that 
  
  
b. Using p-values
  1. Assume that the mean is the value of interest
  2. Evaluate how likely/unlikely the collected data are under the assumption
  3. Reject the assumption 
  
  
---
### A few things to note

  * Both these problems are framed in terms of rejecting an assumption if the observed data turns out to be very unlikely given the assumptions
  
  * These approaches should be correct most of the time in the long run, but may be wrong for any individual scenario.
    * in fact, at a 95% confidence level we expect that we would incorrectly reject the hypothesis 5% of the time i.e. 1 out of every 20 occasions


---
### An example problem

A survey of 204 residents of the New York City metropolitan area, found that the average commuting time for the respondents was 36.94 minutes with a standard deviation of 30.1 minutes. Is there evidence to support a theory that the average commuting time for all residents of the NYC-metro area is 20 minutes?

---
### Back to using p-values for the first time

  * Two essential ingredients:
    * null hypothesis: the theory we would like to reject
    * an alternative hypothesis

In this case:

`$$ H_{0}: \mbox{the mean commuting time in NYC (and environs is 20 minutes)}$$`
`$$ H_{1}: \mbox{the mean commuting time in NYC (and environs not 20 minutes)}$$`


---
### Now to calculate a p-value

Under the null hypothesis (and the CLT):

`$$ \bar{X} \sim N\left(20, \frac{31.1}{\sqrt{204}}\right) $$`

--

So, we can calculate a Z-score for the observed sample mean:

--

`$$ z = \frac{36.94 - 20}{\frac{30.1}{\sqrt{204}} } $$`
--
`$$ z = 8.04$$`
--

`$$\mbox{p: } P(Z &gt; |z| )$$`

`$$ \mbox{p} &lt; .001 $$`


---
### What does the p-value represent

**p-value**: the probability of the observation if the null hypothesis is true

--

So what do we do with the p-value?
--
  Compare it to a pre-chosen level of significance. 
  
  Most common: 
  
`$$ \alpha = 0.05 $$`

--

In this case we reject the null hypothesis because the observation from the survey is very unlikely if the null hypothesis is true.










---
### Inference type 2: CI of mean based on differences in paired data
  
Background: What is paired data?

  * Two samples and there is a correspondence between the items in each
    * each individual in a sample corresponds to a single individual in the other sample
    * Examples:
        * twin studies: one twin in a treatment group; the other in the control group
        * before and after: the same people are measured at the beginning and then again at the end of a experiment
        * wives in one sample; their husbands in the other
        * other pairings based on similarities chosen by researchers


---

  * For each pair calculate the difference in values
  
  * The differences now become sample values
  
  * We can now calculate CIs for the average difference
  


---
### Confidence Interval for the mean difference in paired data

`$$\mbox{CI:} {\bar{x}_{diff}}\pm t^{*}\frac{s_{diff}}{\sqrt{n_{diff}}} $$` 


---
### Example: UCLA Bookstore vs Amazon Prices

Question 1: Construct a confidence interval for the average difference in price between Amazon and the UCLA bookstore

Question 2: Does Amazon offer books at prices equal to the UCLA bookstore on average?



---
### Standard errors for other types of inference problems

  * difference of means (unpaired data)

`$$ SE  = \sqrt{\frac{\sigma^{2}_{1}}{n_1} + \frac{\sigma^{2}_{2}}{n_2}} $$`      
  
--

  * difference of proportions between two groups
  
  `$$ SE = \sqrt{\frac{p(1-p)}{n}} $$`
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
