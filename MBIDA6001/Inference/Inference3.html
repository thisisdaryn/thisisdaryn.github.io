<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>More inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="thisisdaryn at gmail dot com" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# More inference
## Daryn Ramsden
### thisisdaryn at gmail dot com
### last updated: 2019-11-05

---








### Steps in doing a significance test

  * State the null hypothesis, `\(H_{0}\)`
  * State the alternative hypothesis, `\(H_{1}\)`
  * Determine the critical value based on: 
    * the confidence level 
    * the alternative hypothesis: one-sided or two-sided
  * Calculate the test statistic
  * Compare the test statistic to the critical value
  * Reject or fail to reject the null hypothesis based on the comparison 
  

---
### What about one-sided test?

* Sometimes we choose to do a **one-sided** test. 

* Strong reason to believe that the effect is in one particular direction

* In this case, the alternative hypothesis may contain a strict inequality, e.g.
  * `\(H_{1}: \mu &gt; 0\)` 
  * `\(H_{1}: \mu &lt; 0\)`
  
* Gives some more margin for rejecting the null as the critical value becomes smaller

* You have to decide to use a 1-sided test before collecting or looking at the data

* Principle of equipoise generally goes against 1-sided tests. So use them judiciously.


  

---
### Two types of errors

* Type 1 error: rejecting the null hypothesis when it is true
  * Type 1 error rate, `\(\alpha\)`

* Type 2 error: accepting the null hypothesis when it is false
  * Type 2 error rate, `\(\beta\)`
  * Power of a study = 1 - `\(\beta\)` 
  





---
### Statistical Inference for `\((\mu_{1} - \mu_{2})\)`

#### Are the means of two independent populations the same? 


Case 1: 
`\({\sigma_{1}}^2\)` and `\({\sigma_{2}}^2\)` unknown, but assumed to be unequal, `\(n_{1} \geq 30\)` and `\(n_{2} \geq 30\)`

`$$Z = \frac{\bar{X_{1}} - \bar{X_{2}}}{\sqrt{ \frac{s_1^2}{n_{1}} + \frac{s_2^2}{n_{2}}   }} $$`


`$$ \mbox{CI:} \left( \bar{X_{1}} - \bar{X_{2}}\right) \pm Z_{1 - {(\frac{\alpha}{2})}} \sqrt{\frac{{s_1}^2}{n_1} + \frac{{s_2}^2}{n_2} }$$`


--

Case 2: 
`\({\sigma_{1}}^2\)` and `\({\sigma_{2}}^2\)` unknown, but assumed to be unequal, `\(n_{1} &lt; 30\)` and `\(n_{2} &lt; 30\)`
`$$t = \frac{\bar{X_{1}} - \bar{X_{2}}}{\sqrt{ \frac{s}{n_{1}} + \frac{s}{n_{2}}   }} $$`


`$$ \mbox{CI:} \left( \bar{X_{1}} - \bar{X_{2}}\right) \pm t_{1 - {(\frac{\alpha}{2})}} \sqrt{\frac{{s_1}^2}{n_1} + \frac{{s_2}^2}{n_2} }$$`



---
### Testing for equality of variances

  * Take the ratio of the two sample **variances**

--

  * If the ratio is between 0.5 and 2, we consider them to be close enough to equal 

---
### Paired data 

--

Case 1: `\(n \geq 30\)`
`$$Z = \frac{\bar{X_{d}} - \mu_{d}}{{\frac{s_{d}}{\sqrt{n}}}} $$`
   

`$$ \mbox{CI:} \bar{X_{d}} \pm  Z_{1 - {\frac{\alpha}{2}} } \frac{s_{d}}{\sqrt{n}} $$`


--


Case 2: `\(n &lt; 30\)` 
`$$t = \frac{\bar{X_{d}} - \mu_{d}}{{\frac{s_{d}}{\sqrt{n}}}} $$`
   

`$$ \mbox{CI:    } \bar{X_{d}} \pm  t_{1 - {\frac{\alpha}{2}} } \frac{s_{d}}{\sqrt{n}} $$`

`$$ df = n - 1$$`


    
    
    
    
---
### Means of multiple groups


  * Sometimes we want to test if the means of more than 2 groups are equal

  * Common method: ANOVA (Analysis of Variance)
    * A generalisation of the t-test
    * Retain statistical power as the number of groups gets larger better than the t-test does   
  
  * Based on comparing the variability of the group means to the overall variability among the groups




---
### Illustration with 6 groups 


&lt;img src="images/ANOVAIMage.png" width="2795" style="display: block; margin: auto;" /&gt;


---
### General idea

#### If the variability between the groups is large (their means are relatively widely dispersed) and the variability between the groups is small then we reject the null hypothesis that the groups have the same mean.


---
### Doing an ANOVA for k groups

Test Statistic 

`$$ F = \frac{MSG}{MSE} $$`


MSE (Mean square error): Measures the variability within the groups 

`$$ MSE = \displaystyle\sum\limits_{j=1}^{k} \frac{{s_i}^2}{k} = \frac{{s_1}^2 + {s_2}^2 + \cdots  {s_k}^2  }{ k }$$`

`$$df = n - k $$`

--

MSG (Mean square between groups):  measures the variance of the sample means 

`$$ MSG = n\cdot s_{\bar{X{i}}} = \displaystyle\sum\limits_{j=1}^{k} \frac{ \bar{Xj} - \bar{X} }{ k - 1} $$`

`$$ df = k -1 $$`




---
### Using ANOVA in R 

Doing an ANOVA test in R, uses the &lt;tt&gt;aov&lt;/tt&gt; command. 

Example using the entire &lt;tt&gt;flights&lt;/tt&gt; data set


```r
library(nycflights13)
my_test = aov(dep_delay~origin, data=flights)
summary(my_test)
```

```
##                 Df    Sum Sq Mean Sq F value Pr(&gt;F)    
## origin           2   1280515  640258   396.9 &lt;2e-16 ***
## Residuals   328518 529886717    1613                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 8255 observations deleted due to missingness
```

This p-value is really small so we reject the null hypothesis that the average delay is the same at all 3 airports. 





---
### Beginning inference with categorical data


Several different cases:

  * Inference on 1 variable with 2 levels (success/failure, event/no event)
    * Can use inference on proportions 
  
  * Inference on 1 variable with more than 2 levels
    * We use `\(\chi^{2}\)` Goodness of fit tests 
    
  * Inference on 2 categorical variables
    * We use `\(\chi^{2}\)` test of independence






---
### CLT for proportions

`$$ \hat{p} \sim N\left(p, \sqrt{ \frac{p(1-p)}{n} } \right)$$`




#### Note that proportions have to be between 0 and 1 




---
### Confidence Interval for proportions: 


`$$ \hat{p} \pm  Z_{1 - {\frac{\alpha}{2}} } \sqrt{ \frac{\hat{p}(1-\hat{p})}{n}}  $$`


---
### Inference for the difference of two populations


#### Is a certain trait more common in one population than the other

* test statistic 
`$$ Z = \frac{  \hat{p_1}  - \hat{p_2}} {\sqrt{\hat{p}(1 - \hat{p}) \left( \frac{ 1}{n_1 }  + \frac{ 1}{ n_2 }
\right)    }   }  $$`


* Confidence Interval
`$$ (\hat{p_1} - \hat{p_2}) \pm Z_{1 - {\frac{\alpha}{2}} } \frac{  \hat{p_1}  - \hat{p_2}} {\sqrt{\hat{p}(1 - \hat{p}) \left( \frac{ 1}{n_1 }  + \frac{ 1}{ n_2 }
\right)    }   }  $$`





---
### `\(\chi^2\)` Tests

  * Goodness of fit test:
    * used with one categorical variable with more than 2 levels
    
  * Test of independence:
    * to test independence of two categorical variables
    
    
  * General calculation of `\(\chi^{2}\)` test statistic:
    
`$$ \chi^2 = \sum \frac{(O - E) ^2 }{E} $$`
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
